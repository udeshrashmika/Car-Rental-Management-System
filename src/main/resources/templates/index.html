<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Rental Management System</title>

    <style>

        /* --- Global & Reset --- */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    /* Applied 'Inter' font from Design 1 */
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
}

body {
    /* Deep dark background from Design 1 */
    background-color: #121212;
    color: #e0e0e0;
    padding: 20px;
}

/* --- Header --- */
header {
    background-color: #1e1e1e; /* Surface color */
    color: #ffffff;
    padding: 1.5rem;
    border-radius: 12px 12px 0 0;
    text-align: center;
    border-bottom: 1px solid #333;
}

h1 {
    font-size: 1.5rem;
    font-weight: 600;
    color: #fff;
}

h2 {
    margin-bottom: 15px;
    color: #ffffff;
    border-bottom: 1px solid #333;
    padding-bottom: 10px;
    font-size: 1.25rem;
}

/* --- Tabs --- */
.tabs {
    display: flex;
    background-color: #1e1e1e;
    border-radius: 0 0 12px 12px;
    margin-bottom: 20px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    border: 1px solid #333;
    border-top: none;
}

.tab-button {
    flex: 1;
    background: none;
    border: none;
    color: #888; /* Muted text */
    padding: 15px;
    cursor: pointer;
    font-size: 1rem;
    transition: all 0.3s;
    font-weight: 500;
    border-bottom: 2px solid transparent;
}

.tab-button:hover {
    background-color: #2a2a2a;
    color: #fff;
}

.tab-button.active {
    color: #00d4ff; /* Neon Blue */
    font-weight: bold;
    border-bottom: 2px solid #00d4ff;
    background-color: rgba(0, 212, 255, 0.05); /* Subtle glow */
}

/* --- Content Areas --- */
.tab-content {
    display: none;
    background: #1e1e1e; /* Surface color */
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    border: 1px solid #333;
    animation: fadeIn 0.4s;
}

.tab-content.active {
    display: block;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* --- Forms --- */
.form-card {
    background: #2a2a2a; /* Slightly lighter for nested cards */
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #444;
    margin-bottom: 20px;
}

label {
    display: block;
    margin-bottom: 8px;
    color: #bbb; /* Label color from Design 1 */
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 600;
}

input, select {
    width: 100%;
    padding: 12px;
    margin-bottom: 15px;
    /* Input styling from Design 1 */
    background-color: #1e1e1e;
    border: 1px solid #444;
    border-radius: 6px;
    color: white;
    transition: all 0.3s ease;
}

input:focus, select:focus {
    outline: none;
    border-color: #00d4ff; /* Neon blue focus */
    box-shadow: 0 0 8px rgba(0, 212, 255, 0.2);
}

/* --- Buttons --- */
.actions {
    margin-bottom: 15px;
    text-align: right;
}

.primary-btn {
    /* Gradient Button from Design 1 */
    background: linear-gradient(135deg, #007bff, #00d4ff);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.95rem;
    font-weight: 600;
    transition: transform 0.2s, opacity 0.2s;
}

.primary-btn:hover {
    opacity: 0.9;
    transform: translateY(-1px);
}

.full-width {
    width: 100%;
    margin-top: 10px;
}

.return-btn {
    /* Adjusted to match dark theme (Darker Orange) */
    background: linear-gradient(135deg, #d35400, #e67e22);
}

.action-btn {
    padding: 6px 12px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    color: white;
    font-size: 0.8rem;
    margin-right: 5px;
    transition: opacity 0.2s;
}

.action-btn:hover { opacity: 0.8; }

/* --- Tables --- */
.data-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
}

.data-table th, .data-table td {
    padding: 14px 15px;
    text-align: left;
    border-bottom: 1px solid #333;
    color: #e0e0e0;
}

.data-table th {
    background-color: #2a2a2a;
    color: #fff;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.85rem;
    letter-spacing: 0.5px;
}

.data-table tr:hover {
    background-color: #2a2a2a;
}

/* --- Status Badges (Adjusted for Dark Mode Contrast) --- */
.status {
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: bold;
    text-transform: uppercase;
    display: inline-block;
    letter-spacing: 0.5px;
}

/* Using RGBA for glow effects instead of flat pastels */
.status.available { background-color: rgba(46, 204, 113, 0.2); color: #2ecc71; border: 1px solid rgba(46, 204, 113, 0.3); }
.status.active { background-color: rgba(52, 152, 219, 0.2); color: #3498db; border: 1px solid rgba(52, 152, 219, 0.3); }
.status.rented { background-color: rgba(231, 76, 60, 0.2); color: #e74c3c; border: 1px solid rgba(231, 76, 60, 0.3); }
.status.completed { background-color: rgba(46, 204, 113, 0.2); color: #2ecc71; border: 1px solid rgba(46, 204, 113, 0.3); }
.status.maintenance { background-color: rgba(241, 196, 15, 0.2); color: #f1c40f; border: 1px solid rgba(241, 196, 15, 0.3); }

/* --- Report Dashboard Cards --- */
.summary-card {
    flex: 1;
    text-align: center;
    padding: 25px;
    border-radius: 12px;
    background: #2a2a2a;
    border: 1px solid #444;
    margin: 0 10px; /* Added spacing if flexed */
}

.summary-num {
    font-size: 2.5rem;
    font-weight: bold;
    margin-top: 10px;
    color: #00d4ff; /* Neon accent */
}
    </style>
</head>
<body>

<header>
    <h1>Vehicle Rental System (V-RMS)</h1>
</header>

<div class="tabs">
    <button class="tab-button active" onclick="showTab('fleet')">1. Fleet Management</button>
    <button class="tab-button" onclick="showTab('booking')">2. Booking & Rental</button>
    <button class="tab-button" onclick="showTab('reports')">3. Reports</button>
</div>

<div id="fleet" class="tab-content active">
    <h2>üöó Fleet Management</h2>

    <div class="actions">
        <button class="primary-btn" onclick="toggleAddForm()">‚ûï Add New Vehicle</button>
    </div>

    <div id="addVehicleForm" style="display:none; background:#ecf0f1; padding:20px; border-radius:8px; margin-bottom:20px;">
        <h3>Add New Vehicle</h3>
        <form action="#" th:action="@{/addVehicle}" th:object="${newVehicle}" method="post" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <div>
                <label>Type:</label>
                <select th:field="*{type}">
                    <option value="Car">Car</option>
                    <option value="Truck">Truck</option>
                    <option value="Motorcycle">Motorcycle</option>
                </select>
            </div>
            <div>
                <label>Make/Model:</label>
                <input type="text" th:field="*{makeModel}" placeholder="e.g. Honda Civic" required>
            </div>
            <div>
                <label>VIN:</label>
                <input type="text" th:field="*{vin}" placeholder="e.g. ABC-123" required>
            </div>
            <div>
                <label>Daily Rate ($):</label>
                <input type="number" step="0.01" th:field="*{dailyRate}" placeholder="45.00" required>
            </div>
            <div>
                <label>Status:</label>
                <select th:field="*{status}">
                    <option value="AVAILABLE">Available</option>
                    <option value="MAINTENANCE">In Maintenance</option>
                </select>
            </div>
            <div style="grid-column: span 2;">
                <button type="submit" class="primary-btn full-width">Save Vehicle</button>
            </div>
        </form>
    </div>

    <table class="data-table">
        <thead>
        <tr>
            <th>Type</th>
            <th>Make/Model</th>
            <th>Rate/Day</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="vehicle : ${vehicles}">
            <td th:text="${vehicle.type}">Car</td>
            <td th:text="${vehicle.makeModel} + ' (' + ${vehicle.vin} + ')'">Honda Civic</td>
            <td th:text="${'$' + vehicle.dailyRate}">$45.00</td>

            <td>
                <span th:classappend="${'status ' + #strings.toLowerCase(vehicle.status)}" th:text="${vehicle.status}">
                    AVAILABLE
                </span>
            </td>

            <td>
                <form th:if="${vehicle.status == 'MAINTENANCE'}" action="/vehicle/status" method="post" style="display:inline;">
                    <input type="hidden" name="id" th:value="${vehicle.id}">
                    <input type="hidden" name="status" value="AVAILABLE">
                    <button type="submit" class="action-btn" style="background-color: #27ae60;">
                        ‚úÖ Finish Repair
                    </button>
                </form>

                <form th:if="${vehicle.status == 'AVAILABLE'}" action="/vehicle/status" method="post" style="display:inline;">
                    <input type="hidden" name="id" th:value="${vehicle.id}">
                    <input type="hidden" name="status" value="MAINTENANCE">
                    <button type="submit" class="action-btn" style="background-color: #f39c12;">
                        üîß Service
                    </button>
                </form>

                <span th:if="${vehicle.status == 'RENTED'}" style="color: #999; font-size: 0.9rem;">
                    (Managed in Booking)
                </span>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div id="booking" class="tab-content">
    <h2>üìÖ Booking & Rental Processing</h2>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">

        <div class="form-card">
            <h3 style="color:#27ae60;">üöÄ New Rental Checkout</h3>
            <form action="/rent" method="post">
                <label>Customer Name/License:</label>
                <input type="text" name="customerName" placeholder="e.g. John Doe" required>

                <label>Select Available Vehicle:</label>
                <select name="vehicleId" required>
                    <option th:each="v : ${vehicles}"
                            th:if="${v.status == 'AVAILABLE'}"
                            th:value="${v.id}"
                            th:text="${v.makeModel} + ' - $' + ${v.dailyRate} + '/day'">
                    </option>
                </select>

                <label>Start Date:</label>
                <input type="date" name="startDate" required>

                <label>Expected End Date:</label>
                <input type="date" name="endDate" required>

                <button type="submit" class="primary-btn full-width">Confirm Rental</button>
            </form>
        </div>

        <div class="form-card">
            <h3 style="color:#e67e22;">üì• Return Vehicle</h3>
            <form action="/return" method="post">
                <label>Select Active Rental:</label>
                <select name="rentalId" required>
                    <option th:each="r : ${rentals}"
                            th:if="${r.status == 'ACTIVE'}"
                            th:value="${r.id}"
                            th:text="${r.vehicle.makeModel} + ' (Rented by: ' + ${r.customerName} + ')'">
                    </option>
                </select>

                <p style="font-size: 0.9rem; color: #666; margin-top: 10px;">
                    * Total cost will be calculated automatically based on today's return date.
                </p>

                <button type="submit" class="primary-btn full-width return-btn">Process Return</button>
            </form>
        </div>
    </div>

    <h3>üìú Recent Rental History</h3>
    <table class="data-table">
        <thead>
        <tr>
            <th>Customer</th>
            <th>Vehicle</th>
            <th>Start Date</th>
            <th>Return Date</th>
            <th>Status</th>
            <th>Total Cost</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="rental : ${rentals}">
            <td th:text="${rental.customerName}">John Doe</td>
            <td th:text="${rental.vehicle.makeModel}">Honda Civic</td>
            <td th:text="${rental.startDate}">2023-10-01</td>
            <td th:text="${rental.returnDate != null ? rental.returnDate : '-'}">-</td>
            <td>
                <span th:classappend="${'status ' + #strings.toLowerCase(rental.status)}" th:text="${rental.status}">ACTIVE</span>
            </td>
            <td th:text="${rental.totalCost != null ? '$' + rental.totalCost : 'Calculating...'}">$0.00</td>
        </tr>
        </tbody>
    </table>
</div>

<div id="reports" class="tab-content">
    <h2>üìä Availability & Maintenance Reports</h2>

    <div style="display: flex; gap: 20px; margin-bottom: 20px;">
        <div class="summary-card" style="border-left: 5px solid #2c3e50;">
            <h3>Total Fleet</h3>
            <p class="summary-num" th:text="${totalCount}">0</p>
        </div>
        <div class="summary-card" style="border-left: 5px solid #e74c3c;">
            <h3>Currently Rented</h3>
            <p class="summary-num" th:text="${rentedCount}">0</p>
        </div>
        <div class="summary-card" style="border-left: 5px solid #f1c40f;">
            <h3>‚ö†Ô∏è In Maintenance</h3>
            <p class="summary-num" th:text="${maintenanceCount}">0</p>
        </div>
    </div>

    <div class="report-filters" style="margin-bottom: 15px; background: #ecf0f1; padding: 10px; border-radius: 5px;">
        <label for="report-filter" style="display:inline; margin-right: 10px;">Filter View:</label>
        <select id="report-filter" onchange="filterReportTable()" style="display:inline; width: 200px; margin:0;">
            <option value="all">Show All Vehicles</option>
            <option value="RENTED">Rented</option>
            <option value="MAINTENANCE">In-Maintenance</option>
            <option value="AVAILABLE">Available</option>
        </select>
    </div>

    <table class="data-table">
        <thead>
        <tr>
            <th>Vehicle</th>
            <th>VIN</th>
            <th>Status</th>
            <th>Notes</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="v : ${vehicles}" class="report-row" th:data-status="${v.status}">
            <td th:text="${v.makeModel}">Honda Civic</td>
            <td th:text="${v.vin}">ABC-123</td>
            <td>
                <span th:classappend="${'status ' + #strings.toLowerCase(v.status)}" th:text="${v.status}">
                    RENTED
                </span>
            </td>
            <td>
                <span th:if="${v.status == 'RENTED'}">üöó Currently out with customer</span>
                <span th:if="${v.status == 'MAINTENANCE'}">üîß Needs Service</span>
                <span th:if="${v.status == 'AVAILABLE'}">‚úÖ Ready for rent</span>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<script>

    function showTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        event.target.classList.add('active');
    }


    function toggleAddForm() {
        var form = document.getElementById('addVehicleForm');
        form.style.display = (form.style.display === 'none') ? 'block' : 'none';
    }


    function filterReportTable() {
        var filter = document.getElementById("report-filter").value;
        var rows = document.querySelectorAll(".report-row");

        rows.forEach(row => {
            if (filter === "all" || row.getAttribute("data-status") === filter) {
                row.style.display = "";
            } else {
                row.style.display = "none";
            }
        });
    }
</script>
</body>
</html>